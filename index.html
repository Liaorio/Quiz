<!DOCTYPE>
<html>
<meta charset="utf-8"></meta>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Example</title>
<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
<link rel="stylesheet" type="text/css" href="vendor/slick/slick-theme.css">
<link rel="stylesheet" type="text/css" href="./style.css">
</head>

<body>

<!-- Dependencies -->
<div class="cmsQuiz">

</div>


<script src="vendor/jquery-3.2.1.min.js"></script>
<script src="vendor/slick/slick.js" charset="utf-8"></script>
<script src="vendor/jquery.lazyload.js"></script>
<script>

    var outerHtmlElement = '<div class="quiz-container-inner"><div class="quiz-title"><div class="quiz-main-title"></div><div class="quiz-sub-title"></div></div><div class="slick-part"></div><div class="quiz-result"></div></div>';

    $('.cmsQuiz').append(outerHtmlElement);

    $.ajaxSettings.async = false;
    $.getJSON("./example.json",function(data) {

        var content = data.content;

        $('.quiz-main-title').html(content.title);
        $('.quiz-sub-title').html(content.description);

        var questions = content.questions;
        var number = questions.length;

//        $.each(questions, function(key, val) {
//
//            //题目页面
//            $('.slick-part').append(
//                "<div class='slick-item'>" +
//                    "<div class='quiz-image'>" +
//                        "<img class='lazy' data-original='"+ val.img +"' width='100%' height='200px'>" +
//                    "</div>" +
//                    "<div class='quiz-question'>" +
//                        "<div class='quiz-question-num-container'>" +
//                            "<div class='quiz-question-num'>" + (key + 1) + "</div>" +
//                        "</div>" +
//                        "<div class='quiz-question-text'>" +
//                            val.question +
//                        "</div>" +
//                        "<div class='quiz-question-options'>" +
//                            "<ul id='question_" + key + "'>" +
//                                "<li id='question_"+ key +"_1_li'>" +
//                                    "<input type='radio' name='question_" + key + "' id='question_" + key + "_1_option'>" +   val.options1 +
//                                "</li>" +
//                                "<li id='question_" + key + "_2_li'>" +
//                                    "<input type='radio' name='question_" + key + "' id='question_" + key + "_2_option'>" +   val.options2 +
//                                "</li>" +
//                                "<li id='question_" + key + "_3_li'>" +
//                                    "<input type='radio' name='question_" + key + "' id='question_" + key + "_3_option'>" +   val.options3 +
//                                "</li>" +
//                                "<li id='question_" + key + "_4_li'>" +
//                                    "<input type='radio' name='question_" + key + "' id='question_" + key + "_4_option'>" +   val.options4 +
//                                "</li>" +
//                            "</ul>" +
//                        "</div>" +
//                    "</div>" +
//                    "<div class='nextButton' id='next_"+ key +"'>" + "Next" + "</div>" +
//                "</div>"
//            );
//
//            //题目答案页面
//            $(".quiz-result").append(
//                "<div id='result_question_" + key + "'>" + "</div>"
//            );
//
//        });

        //结果页面
        $('.slick-part').append(
            "<div class='slick-item'>" +
                "<div class='score-div'>" +
                    "<h1>" + "Your Score" +
                        "<div class='score-part'>" +
                            "<span class='score'>" + 0 + "</span>" + "&nbsp;&nbsp;/&nbsp;&nbsp;" + number +
                        "</div>" +
                        "Let your friends and the word know" +
                    "</h1>" +
                    "<div class='icon-list'>" +
//            <div class="share">
//            <!--#set(String share_title = m_top_headline)-->
//            <a class="mail" href="#" target="_blank" share_title="${share_title}"><img src="${baseUrl}/m_resources/images/share_icon/mail@3x.png"/></a>
//            <a class="tumblr" href="#" target="_blank" share_title="${share_title}"><img src="${baseUrl}/m_resources/images/share_icon/tumblr@3x.png"/></a>
//            <a class="weibo" href="#" target="_blank" share_title="${share_title}"><img src="${baseUrl}/m_resources/images/share_icon/weibo@3x.png"/></a>
//            <a class="wechat" href="javascript:;" target="_blank" share_title="${share_title}"><img src="${baseUrl}/m_resources/images/share_icon/wechat@3x.png"/></a>
//            <a class="twitter" href="#" target="_blank" share_title="${share_title}"><img src="${baseUrl}/m_resources/images/share_icon/twitter@3x.png"/></a>
//            <a class="facebook" href="#" target="_blank" share_title="${share_title}"><img src="${baseUrl}/m_resources/images/share_icon/facebook@3x.png"/></a>
//            </div>
                    "</div>" +
                "</div>" +
            "</div>"
        );

        $(".quiz-result").append(
            "<div id='result_question_last'>" + "</div>"
        );


    });


    $(document).ready(function () {

        var score = 0;

        $("img.lazy").lazyload();
//
//        $('.slick-part').slick({
//            dots: false,
//            draggable: false,
//            infinite: false,
//            asNavFor: '.quiz-result',
//            nextArrow: $('.nextButton'),
//        });

//        $('.quiz-result').slick({
//            asNavFor:'.slick-part',
//            infinite: false,
//            fade: true,
//            arrows: false,
//        });

        $('.quiz-question-options ul li').click(function (e) {

            //input选中
            var option_input = e.target.childNodes[0] ? e.target.childNodes[0] : e.target;
            var option_input_id = option_input.getAttribute("id");
            $('#' + option_input_id).attr('checked',true);

            //li背景颜色改变
            var option_li = e.target.parentNode.nodeName == 'LI' ? e.target.parentNode : e.target;
            var option_li_id = option_li.getAttribute('id');
            $('#' + option_li_id).css('background','#B4A24E');

            //ul不能被点击
            var question_id = option_input.getAttribute("name");
            $("#" + question_id).css('pointer-events','none');
            $("#" + question_id).css('color','#efefef');

            //答案显示
            var question_answered = option_input_id.split('_')[1];
            var option_choose = option_input_id.split('_')[2];

            $.ajaxSettings.async = false;
            $.getJSON("./example.json",function(data) {
                var question = data.content.questions[question_answered];
                var result = option_choose == question.rightAnswer ? 'Correct' : 'Wrong';
                var feedback = question.explanation;

                $('#result_question_' + question_answered ).append(
                    "<div class='quiz-result-title'>" + result + "!" + "</div>" +
                    "<div class='quiz-result-text'>" +  feedback + "</div>"
                )

                if (result == 'Correct') {score++;}  //得分加一
            })

            //nextButton显示
            $("#next_" + question_answered).css('visibility','visible');

            //分数显示
            $(".score").html(score);
        })

    })
</script>
</body>

</html>